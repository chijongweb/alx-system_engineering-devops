#!/bin/bash
# This script sets up port forwarding from port 8080 to port 80 using UFW (iptables)

# Ensure the port forwarding rule exists in /etc/ufw/before.rules
if ! grep -q "REDIRECT --to-port 80" /etc/ufw/before.rules; then
  sudo sed -i '/^# START PORT FORWARDING RULE/,$d' /etc/ufw/before.rules
  sudo tee -a /etc/ufw/before.rules > /dev/null <<EOF
# START PORT FORWARDING RULE
*nat
:PREROUTING ACCEPT [0:0]
-A PREROUTING -p tcp --dport 8080 -j REDIRECT --to-port 80
COMMIT
# END PORT FORWARDING RULE
EOF
fi
